{"version":3,"sources":["../../../../widgets/FiltroCascada/setting/Setting.js"],"names":["declare","BaseWidgetSetting","_WidgetsInTemplateMixin","QueryTask","Query","lang","LayerInfos","array","dom","on","esriRequest","TableContainer","html","Select","TextBox","Button","Textarea","domConstruct","registry","baseClass","onOpen","console","log","startup","inherited","arguments","config","i","features","_createListElements","iddiv","url","idfeaturesSelected","title","e","max_id","Object","keys","length","Math","max","map","parseInt","o","split","_contador","_divIdPref","_keyIdPref","_layerInfosObjClone","postCreate","self","_setListLayers","NodeUrlDepa","NodeFieldLabelDepa","NodeFieldValueDepa","NodeUrlProv","NodeFieldLabelProv","NodeFieldValueProv","NodeUrlDist","NodeFieldLabelDist","NodeFieldValueDist","_populateSelect","setConfig","_config","_features","set","departamento","id","labelOptions","valueOptions","label","value","provincia","distrito","getConfig","options","dojonodeService","dojonodeAlias","dojonodeValue","getInstance","itemInfo","then","hitch","layerInfosObj","infos","getLayerInfoArray","arrayLayers","getSubLayers","arrayoptions","_listSubLayerdOfRootLayer","push","apply","optSubLayers","_layerInfos","concat","infoSubLayers","evt","selectedLayer","getLayerInfoById","getUrl","response","fields","optionFields","forEach","field","alias","name","optionsSublayers","infosSublayers","recursiveSubLayers","sublayers","NodeFeatures","_addRowLayerSelected","layer","keyf","controler","reg","byId","contenedor","titulo","dojo","destroy","container","create","style","display","sel","width","but","spanLabel","onClick","customClass","readonly","border","font","containerhtml","document","getElementById","placeAt"],"mappings":"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","file":"Setting.js","sourcesContent":["import declare from 'dojo/_base/declare';\r\nimport BaseWidgetSetting from 'jimu/BaseWidgetSetting';\r\nimport _WidgetsInTemplateMixin from 'dijit/_WidgetsInTemplateMixin';\r\nimport QueryTask from 'esri/tasks/QueryTask';\r\nimport Query from 'esri/tasks/query';\r\nimport lang from 'dojo/_base/lang';\r\nimport LayerInfos from 'jimu/LayerInfos/LayerInfos';\r\nimport array from 'dojo/_base/array';\r\nimport dom from \"dojo/dom\";\r\nimport on from \"dojo/on\";\r\nimport esriRequest from \"esri/request\";\r\nimport TableContainer from 'dojox/layout/TableContainer';\r\nimport html from \"dojo/html\";\r\nimport Select from \"dijit/form/Select\";\r\nimport TextBox from \"dijit/form/TextBox\";\r\nimport Button from \"dijit/form/Button\";\r\nimport Textarea from \"dijit/form/Textarea\";\r\nimport domConstruct from \"dojo/dom-construct\";\r\nimport registry from \"dijit/registry\";\r\n\r\n\r\n\r\n\r\nexport default declare([\r\n    BaseWidgetSetting,\r\n    _WidgetsInTemplateMixin,\r\n    QueryTask,\r\n    Query,\r\n], {\r\n\r\n    baseClass: 'filter-features-setting',\r\n    onOpen: function() {\r\n        console.log('FilterFeatures::onOpen');\r\n        \r\n      },\r\n\r\n\r\n    startup: function() {\r\n        this.inherited(arguments);\r\n        //this.setConfig(this.config);\r\n\r\n        // nueva funcion para cargar selecciones\r\n        config = this.config;\r\n        debugger\r\n        for (var i in config.features){\r\n            try{\r\n                \r\n            this._createListElements(i, config.features[i].iddiv, config.features[i].url, this.idfeaturesSelected, config.features[i].title);\r\n            }\r\n            catch(e){\r\n                console.log('no se actualizaron features');\r\n                console.log(e);\r\n            }\r\n        }\r\n\r\n        max_id=0;\r\n        try{\r\n            if(Object.keys(config.features).length>0){\r\n                max_id = Math.max(...Object.keys(config.features).map(o => parseInt(o.split(\"_\")[1])));\r\n            }\r\n        }\r\n        catch(e){\r\n            max_id=0;\r\n            console.log(\"No existen registros\");\r\n        }\r\n\r\n        \r\n\r\n\r\n        _contador = max_id;\r\n        // _features = {};\r\n        _divIdPref = 'divff_';\r\n        _keyIdPref = 'keyff_';\r\n        _layerInfosObjClone;\r\n    },\r\n\r\n    postCreate() {\r\n\r\n        self = this;\r\n        \r\n        this._setListLayers(this.NodeUrlDepa, this.NodeFieldLabelDepa, this.NodeFieldValueDepa);\r\n        this._setListLayers(this.NodeUrlProv, this.NodeFieldLabelProv, this.NodeFieldValueProv);\r\n        this._setListLayers(this.NodeUrlDist, this.NodeFieldLabelDist, this.NodeFieldValueDist);\r\n\r\n        // this._gridxLayers();\r\n        this._populateSelect();\r\n        \r\n        if(this.config){\r\n            this.setConfig(this.config);\r\n          }\r\n\r\n    },\r\n\r\n    setConfig: function(_config) {\r\n        \r\n        _features = _config.features;\r\n        var config = _config;\r\n        // this.NodeUrlDepa.set('options', config.departamento.options);\r\n        this.NodeUrlDepa.set('value', config.departamento.id);\r\n        this.NodeFieldLabelDepa.set('options', config.departamento.labelOptions);\r\n        this.NodeFieldValueDepa.set('options', config.departamento.valueOptions);\r\n        this.NodeFieldLabelDepa.set('value', config.departamento.label);\r\n        this.NodeFieldValueDepa.set('value', config.departamento.value);\r\n\r\n        // this.NodeUrlProv.set('options', config.provincia.options);\r\n        this.NodeUrlProv.set('value', config.provincia.id);\r\n        this.NodeFieldLabelProv.set('options', config.provincia.labelOptions);\r\n        this.NodeFieldValueProv.set('options', config.provincia.valueOptions);\r\n        this.NodeFieldLabelProv.set('value', config.provincia.label);\r\n        this.NodeFieldValueProv.set('value', config.provincia.value);\r\n\r\n        // this.NodeUrlDist.set('options', config.distrito.options);\r\n        this.NodeUrlDist.set('value', config.distrito.id);\r\n        this.NodeFieldLabelDist.set('options', config.distrito.labelOptions);\r\n        this.NodeFieldValueDist.set('options', config.distrito.valueOptions);\r\n        this.NodeFieldLabelDist.set('value', config.distrito.label);\r\n        this.NodeFieldValueDist.set('value', config.distrito.value);\r\n\r\n        // for (var i in config.features){\r\n        //     try{\r\n        //     this._createListElements(i, config.features[i].iddiv, config.features[i].url, this.idfeaturesSelected, config.features[i].title);\r\n        //     }\r\n        //     catch(e){\r\n        //         console.log('no se actualizaron features');\r\n        //         console.log(e);\r\n        //     }\r\n        // }\r\n\r\n    },\r\n\r\n    getConfig: function(){\r\n        // var idSelect;\r\n        // var idButton;\r\n        // for (i = 0; i < _contador; i++) {\r\n        //   idSelect = \"selectFF_${i}\";\r\n        // }\r\n        debugger\r\n\r\n        var config =\r\n         {\r\n            departamento: {\r\n                'id': this.NodeUrlDepa.value,\r\n                'label': this.NodeFieldLabelDepa.value,\r\n                'value': this.NodeFieldValueDepa.value,\r\n                'labelOptions': this.NodeFieldLabelDepa.options,\r\n                'valueOptions': this.NodeFieldValueDepa.options\r\n            },\r\n            provincia: {\r\n                'id': this.NodeUrlProv.value,\r\n                'label': this.NodeFieldLabelProv.value,\r\n                'value': this.NodeFieldValueProv.value,\r\n                'labelOptions': this.NodeFieldLabelProv.options,\r\n                'valueOptions': this.NodeFieldValueProv.options\r\n            },\r\n            distrito: {\r\n                'id': this.NodeUrlDist.value,\r\n                'label': this.NodeFieldLabelDist.value,\r\n                'value': this.NodeFieldValueDist.value,\r\n                'labelOptions': this.NodeFieldLabelDist.options,\r\n                'valueOptions': this.NodeFieldValueDist.options\r\n            },\r\n            features: _features\r\n        };\r\n        return config;\r\n    },\r\n\r\n    _setListLayers(dojonodeService, dojonodeAlias, dojonodeValue) {\r\n        LayerInfos.getInstance(this.map, this.map.itemInfo)\r\n            .then(lang.hitch(this, function(layerInfosObj) {\r\n                var infos = layerInfosObj.getLayerInfoArray();\r\n                _layerInfosObjClone = layerInfosObj;\r\n                var options = [];\r\n                for (var i in infos) {\r\n                    var arrayLayers = infos[i].getSubLayers();\r\n                    if (arrayLayers.length > 0) {\r\n                        var arrayoptions = this._listSubLayerdOfRootLayer(arrayLayers);\r\n                        options.push.apply(options, arrayoptions.optSubLayers);\r\n                        _layerInfosObjClone._layerInfos = _layerInfosObjClone._layerInfos.concat(arrayoptions.infoSubLayers);\r\n                    } else {\r\n                        options.push({\r\n                            label: infos[i].title,\r\n                            value: infos[i].id,\r\n                            // value: infos[i].layerObject.url,\r\n                        })\r\n                    }\r\n                };\r\n                dojonodeService.options = options;\r\n\r\n                dojonodeService.on('change', function(evt) {\r\n                    var selectedLayer = _layerInfosObjClone.getLayerInfoById(evt);\r\n\r\n                    var url = selectedLayer.getUrl();\r\n                    esriRequest({\r\n                        url: url + \"?f=json\"\r\n                        // url: evt + \"?f=json\"\r\n                    }).then(function(response) {\r\n                        var fields = response.fields;\r\n                        var optionFields = []\r\n                        fields.forEach(function(field) {\r\n                            optionFields.push({\r\n                                label: field.alias,\r\n                                value: field.name,\r\n                            })\r\n                        })\r\n                        dojonodeAlias.set('options', optionFields);\r\n                        dojonodeValue.set('options', optionFields);\r\n                    });\r\n                })\r\n            }));\r\n    },\r\n\r\n    _listSubLayerdOfRootLayer(arrayLayers) {\r\n        var optionsSublayers = [];\r\n        var infosSublayers = [];\r\n        recursiveSubLayers(arrayLayers);\r\n\r\n        function recursiveSubLayers(arrayLayers) {\r\n            for (var i in arrayLayers) {\r\n                var sublayers = arrayLayers[i].getSubLayers();\r\n                if (sublayers.length > 0) {\r\n                    recursiveSubLayers(sublayers)\r\n                } else {\r\n                    optionsSublayers.push({\r\n                        label: arrayLayers[i].title,\r\n                        value: arrayLayers[i].id\r\n                        // value: arrayLayers[i].layerObject.url\r\n                    });\r\n                    infosSublayers.push(arrayLayers[i]);\r\n                }\r\n            }\r\n        };\r\n        return {\r\n            optSubLayers: optionsSublayers,\r\n            infoSubLayers: infosSublayers\r\n        }\r\n    },\r\n\r\n    _populateSelect() {\r\n        this.NodeFeatures.options = self.NodeUrlDepa.options;\r\n        // this.NodeFeatures.on('change', function(evt) {\r\n        //     self._addRowLayerSelected(evt);\r\n        // })\r\n    },\r\n\r\n    _addRowLayerSelected(evt) {\r\n        debugger\r\n        var layer = _layerInfosObjClone.getLayerInfoById(evt)\r\n        var url = layer.getUrl();\r\n        _contador = _contador + 1\r\n        var iddiv = `${_divIdPref}${_contador}`\r\n        var keyf = `${_keyIdPref}${_contador}`\r\n        var controler = true;\r\n\r\n        while (controler) {\r\n          var reg = registry.byId(iddiv);\r\n          if (reg){\r\n            _contador = _contador + 1;\r\n            iddiv = `${_divIdPref}${_contador}`;\r\n            keyf = `${_keyIdPref}${_contador}`;\r\n          }else{\r\n            controler = false;\r\n          }\r\n        }\r\n        // var regregistry.byId(iddiv)\r\n\r\n        // var r = {}\r\n        // r[_contador] = {url: evt}\r\n        debugger\r\n        _features[keyf] = {id: evt, iddiv : iddiv, url:url, field:\"\", title:layer.title};\r\n        \r\n        // for (var x =0 ; x<2; x++){\r\n        //     this._createListElements(keyf+x, iddiv+x, url, \"idfeaturesSelected\", layer.title);\r\n        // }\r\n        this._createListElements(keyf, iddiv, url, \"idfeaturesSelected\", layer.title);\r\n\r\n        // var container = dojo.create(\"div\", {id: iddiv}, \"idfeaturesSelected\");\r\n        // // }\r\n\r\n        // _programmatic = new TableContainer({\r\n        //     cols: 2,\r\n        //     class: \"containerItemsFeatures\",\r\n        //     customClass: \"labelsAndValues\",\r\n        //     \"labelWidth\": \"40%\"\r\n        // }, container);\r\n\r\n        // esriRequest({\r\n        //     url: url + \"?f=json\"\r\n        // }).then(function(response) {\r\n        //     var fields = response.fields;\r\n        //     var optionFields = [{label: '------', value: '0'}]\r\n        //     fields.forEach(function(field) {\r\n        //         optionFields.push({\r\n        //             label: field.alias,\r\n        //             value: field.name,\r\n        //         })\r\n        //     })\r\n        //     var sel = new Select({\r\n        //         // id: `selectFF_${_contador}`,\r\n        //         // name: \"fieldSelect\",\r\n        //         options: optionFields,\r\n        //         style:{width: \"300px\"},\r\n        //         label: response.name,\r\n        //     });\r\n\r\n        //     sel.on(\"change\", function(evt){\r\n        //       _features[keyf][\"field\"] = evt;\r\n        //     })\r\n\r\n        //     var but = new Button({\r\n        //         // id: `buttonFF_${_contador}`,\r\n        //         // name: \"removeButton\",\r\n        //         label: \"remover\",\r\n        //         spanLabel: true,\r\n        //         onClick:\r\n        //           function(){\r\n        //             delete _features[keyf]; \r\n        //             domConstruct.destroy(iddiv);\r\n        //           }\r\n        //     })\r\n\r\n        //     _programmatic.addChild(sel);\r\n        //     _programmatic.addChild(but);\r\n        //     _programmatic.startup();\r\n        // })\r\n\r\n    \r\n\r\n        // Create four text boxes\r\n\r\n        // var sel = new Select({\r\n        //   name: \"fieldSelect\",\r\n        //   options: [{label:1, value:1}],\r\n        //   label: \"checar\"\r\n        // })\r\n\r\n        // var text1 = new TextBox({\r\n        //     label: \"ProgText 1\"\r\n        // });\r\n        // var text2 = new TextBox({\r\n        //     label: \"ProgText 2\"\r\n        // });\r\n        // var text3 = new TextBox({\r\n        //     label: \"ProgText 3\"\r\n        // });\r\n        // var text4 = new TextBox({\r\n        //     label: \"ProgText 4\"\r\n        // });\r\n\r\n        // Add the four text boxes to the TableContainer\r\n        // programmatic.addChild(sel);\r\n        // programmatic.addChild(text2);\r\n        // programmatic.addChild(text3);\r\n        // programmatic.addChild(text4);\r\n\r\n        // Start the table container. This initializes it and places\r\n        // the child widgets in the correct place.\r\n        // programmatic.startup();\r\n    },\r\n\r\n    _createListElements: function(keyf, iddiv, url, contenedor, titulo){\r\n        debugger\r\n        dojo.destroy(iddiv);\r\n        var container = dojo.create(\"div\", {id: iddiv, style:{display: \"block\", \"margin-top\": \"5px\"}}, contenedor);\r\n        // }\r\n\r\n        // _programmatic = new TableContainer({\r\n        //     cols: 2,\r\n        //     class: \"containerItemsFeatures\",\r\n        //     customClass: \"labelsAndValues\",\r\n        //     showLabels: true,\r\n        //     \"labelWidth\": \"40%\"\r\n        // }, container);\r\n\r\n        esriRequest({\r\n            url: url + \"?f=json\"\r\n        }).then(function(response) {\r\n            var fields = response.fields;\r\n            var optionFields = [{label: '------', value: '0'}]\r\n            fields.forEach(function(field) {\r\n                optionFields.push({\r\n                    label: field.alias,\r\n                    value: field.name,\r\n                })\r\n            })\r\n            var sel = new Select({\r\n                // id: `selectFF_${_contador}`,\r\n                // name: \"fieldSelect\",\r\n                options: optionFields,\r\n                style:{width: \"300px\"},\r\n                label: titulo,\r\n            });\r\n\r\n            if(!!_features[keyf][\"field\"]){\r\n                sel.set('value',_features[keyf][\"field\"]);\r\n            };\r\n\r\n            sel.on(\"change\", function(evt){\r\n              _features[keyf][\"field\"] = evt;\r\n            });\r\n\r\n            var but = new Button({\r\n                // id: `buttonFF_${_contador}`,\r\n                // name: \"removeButton\",\r\n                label: \"remover\",\r\n                spanLabel: true,\r\n                onClick:\r\n                  function(){\r\n                    delete _features[keyf]; \r\n                    domConstruct.destroy(iddiv);\r\n                  }\r\n            });\r\n\r\n            var label = new Textarea({\r\n                name: \"myarea\",\r\n                customClass: \"noHover\",\r\n                value: titulo,\r\n                readonly: true,\r\n                style: {width: \"200px\", border: 0, \"pointer-events\":\"none\", font:\"12px 'Avenir Light', Verdana, Geneva, sans-serif\"}\r\n            }, \"myarea\");\r\n            \r\n\r\n            // _programmatic.addChild(sel);\r\n            // _programmatic.addChild(but);\r\n            containerhtml=document.getElementById(iddiv);\r\n\r\n            label.placeAt(containerhtml);\r\n            sel.placeAt(containerhtml);\r\n            but.placeAt(containerhtml);\r\n            // _programmatic.startup();\r\n        })\r\n    }\r\n\r\n\r\n\r\n})\r\n"]}