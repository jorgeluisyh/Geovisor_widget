{"version":3,"sources":["../../../widgets/FiltroCascada/Widget.js"],"names":["declare","BaseWidget","_WidgetsInTemplateMixin","Query","QueryTask","dom","on","lang","LayerInfos","Dialog","genFunction","registry","baseClass","gf","postCreate","inherited","arguments","console","log","self","startup","defaultEmpty","dojo","byId","textContent","defaultOption","depaSelectAttachPoint","get","_idDepa","config","departamento","id","_fieldCodDepa","value","_fieldNomDepa","label","clause","_clauseTransversal","_idProv","provincia","_fieldCodProv","_fieldNomProv","_idDist","distrito","_fieldCodDist","_fieldNomDist","_layerInfosObjClone","_codFilter","_layerid","getInstance","map","itemInfo","then","hitch","layerInfosObj","infos","getLayerInfoArray","_popLayers","_filterOptions","options","features","i","opt","title","push","LayerSelectAttachPoint","addOption","_filterLayer","evt","_filterFeatureDepa","_zoomExtendSelected","provSelectAttachPoint","_filterFeatureProv","distSelectAttachPoint","_filterFeatureDist","idService","valueField","labelField","dojonodeAlias","feature","getLayerInfoById","urlService","getUrl","queryTask","query","where","outFields","execute","results","attributes","_sortArray","set","field","setFilter","show","_setMapExtent","executeForExtent","response","extent","setExtent","_filterFeatures","spinner","document","getElementsByClassName","style","visibility","errorDialog","content","url","idFeature","_setClauseTraversal","_turnLayers","_toggleEnabledForm","toggle","buttonFiltrarff","_newFilter","children","depaoption","innerHTML","e","_clearFilter"],"mappings":"QAAoB,oB,EACG,iB,EACa,+B,EAClB,kB,EACI,sB,EACN,U,EACD,S,EACE,iB,EACM,4B,EACJ,c,EACK,gB,EACH,gB,aAXdA,O,EACAC,U,EACAC,uB,EACAC,K,EACAC,S,EACAC,G,EACAC,E,EACAC,I,EACAC,U,EACAC,M,EACAC,W,EACAC,Q;SAGQX,QAAQ,CACrBC,UADqB,EAErBC,uBAFqB,EAGrBC,KAHqB,EAIrBC,SAJqB,CAAR,EAID;;AAEZ;;AAEAQ,eAAW,iBAJC;AAKZC,QAAIH,aALQ;;AAUZI,cAVY,wBAUE;AACZ,WAAKC,SAAL,CAAeC,SAAf;AACAC,cAAQC,GAAR,CAAY,4BAAZ;AACAC,aAAO,IAAP;AAED,KAfW;AAiBZC,WAjBY,qBAiBF;AACR,WAAKL,SAAL,CAAeC,SAAf;AACAG,aAAO,IAAP;AACAA,WAAKE,YAAL,GAAoBC,KAAKC,IAAL,CAAU,QAAV,EAAoBC,WAAxC;AACAL,WAAKM,aAAL,GAAqBN,KAAKO,qBAAL,CAA2BC,GAA3B,CAA+B,OAA/B,CAArB;;AAGAC,gBAAU,KAAKC,MAAL,CAAYC,YAAZ,CAAyBC,EAAnC;AACAC,sBAAgB,KAAKH,MAAL,CAAYC,YAAZ,CAAyBG,KAAzC;AACAC,sBAAgB,KAAKL,MAAL,CAAYC,YAAZ,CAAyBK,KAAzC;AACAC,eAAYJ,aAAZ;AACAK,2BAAqB,EAArB;;AAEAC,gBAAU,KAAKT,MAAL,CAAYU,SAAZ,CAAsBR,EAAhC;AACAS,sBAAgB,KAAKX,MAAL,CAAYU,SAAZ,CAAsBN,KAAtC;AACAQ,sBAAgB,KAAKZ,MAAL,CAAYU,SAAZ,CAAsBJ,KAAtC;;AAEAO,gBAAU,KAAKb,MAAL,CAAYc,QAAZ,CAAqBZ,EAA/B;AACAa,sBAAgB,KAAKf,MAAL,CAAYc,QAAZ,CAAqBV,KAArC;AACAY,sBAAgB,KAAKhB,MAAL,CAAYc,QAAZ,CAAqBR,KAArC;;AAEAW,4BAAsB,EAAtB;AACAC,mBAAa,IAAb;AACAC,iBAAW,GAAX;AACA;;AAEAxC,iBAAWyC,WAAX,CAAuB,KAAKC,GAA5B,EAAiC,KAAKA,GAAL,CAASC,QAA1C,EACCC,IADD,CACM7C,KAAK8C,KAAL,CAAW,IAAX,EAAiB,UAASC,aAAT,EAAwB;AAC3CR,8BAAsBQ,aAAtB;AACA,YAAIC,QAAQD,cAAcE,iBAAd,EAAZ;AACA;AACD,OAJG,CADN;;AAQA,WAAKC,UAAL;;AAEA,WAAKC,cAAL,CAAoB9B,OAApB,EAA6B,IAA7B,EAAmCQ,MAAnC,EAA2CJ,aAA3C,EAA0DE,aAA1D,EAAyEf,KAAKO,qBAA9E;AACD,KAtDW;AAwDZ+B,cAxDY,wBAwDA;AACV,UAAIE,UAAS,EAAb;AACA,UAAIC,WAAW,KAAK/B,MAAL,CAAY+B,QAA3B;;AAEA,WAAK,IAAIC,CAAT,IAAcD,QAAd,EACA;AACE,YAAIE,MAAM;AACR3B,iBAAOyB,SAASC,CAAT,EAAYE,KADX;AAER9B,iBAAO2B,SAASC,CAAT,EAAY9B;AAFX,SAAV;AAIA4B,gBAAQK,IAAR,CAAaF,GAAb;AACA,aAAKG,sBAAL,CAA4BC,SAA5B,CAAsCJ,GAAtC;AACD;AACF,KArEW;AAuEZK,gBAvEY,wBAuECC,GAvED,EAuEK;AACfpB,iBAAWoB,GAAX;AACD,KAzEW;AA2EZC,sBA3EY,8BA2EOD,GA3EP,EA2EW;AACrB;AACA,UAAIhC,SAAYI,aAAZ,gBAAmC4B,GAAnC,QAAJ;;AAEA,WAAKE,mBAAL,CAAyB1C,OAAzB,EAAkCI,aAAlC,EAAiDoC,GAAjD;AACA,WAAKV,cAAL,CAAoBpB,OAApB,EAA6B8B,GAA7B,EAAkChC,MAAlC,EAA0CI,aAA1C,EAAyDC,aAAzD,EAAwEtB,KAAKoD,qBAA7E;AACD,KAjFW;AAmFZC,sBAnFY,8BAmFOJ,GAnFP,EAmFW;AACrB,UAAIhC,SAAYQ,aAAZ,gBAAmCwB,GAAnC,QAAJ;;AAEA,WAAKE,mBAAL,CAAyBhC,OAAzB,EAAkCE,aAAlC,EAAiD4B,GAAjD;AACA,WAAKV,cAAL,CAAoBhB,OAApB,EAA6B0B,GAA7B,EAAkChC,MAAlC,EAA0CQ,aAA1C,EAAyDC,aAAzD,EAAwE1B,KAAKsD,qBAA7E;AACD,KAxFW;AA0FZC,sBA1FY,8BA0FON,GA1FP,EA0FW;AACrBrB,mBAAaqB,GAAb;AACA,WAAKE,mBAAL,CAAyB5B,OAAzB,EAAkCE,aAAlC,EAAiDG,UAAjD;AACD,KA7FW;AA+FZW,kBA/FY,0BA+FGiB,SA/FH,EA+Fc1C,KA/Fd,EA+FqBG,MA/FrB,EA+F6BwC,UA/F7B,EA+FyCC,UA/FzC,EA+FqDC,aA/FrD,EA+FmE;AAC7E/B,mBAAad,KAAb;AACA,UAAI8C,UAAUjC,oBAAoBkC,gBAApB,CAAqCL,SAArC,CAAd;AACAM,mBAAaF,QAAQG,MAAR,EAAb;;AAEA,UAAIvB,UAAU,EAAd;AACA,UAAIwB,YAAY,IAAI/E,SAAJ,CAAc6E,UAAd,CAAhB;AACA,UAAIG,QAAQ,IAAIjF,KAAJ,EAAZ;AACAiF,YAAMC,KAAN,GAAcjD,MAAd;AACAgD,YAAME,SAAN,GAAkB,CAACV,UAAD,EAAaC,UAAb,CAAlB;AACAM,gBAAUI,OAAV,CAAkBH,KAAlB,EAAyB,UAASI,OAAT,EAAiB;AACxC,aAAI,IAAI3B,CAAR,IAAa2B,QAAQ5B,QAArB,EAA8B;AAC5B,cAAIE,MAAM;AACR3B,mBAAOqD,QAAQ5B,QAAR,CAAiBC,CAAjB,EAAoB4B,UAApB,CAA+BZ,UAA/B,CADC;AAER5C,mBAAOuD,QAAQ5B,QAAR,CAAiBC,CAAjB,EAAoB4B,UAApB,CAA+Bb,UAA/B;AAFC,WAAV;AAIAjB,kBAAQK,IAAR,CAAaF,GAAb;AACD;AACDH,kBAAUxC,KAAKN,EAAL,CAAQ6E,UAAR,CAAmB/B,OAAnB,EAA4B,OAA5B,CAAV;AACAmB,sBAAca,GAAd,CAAkB,SAAlB,EAA6BhC,OAA7B;AACD,OAVD;AAWD,KApHW;AAsHZW,uBAtHY,+BAsHQK,SAtHR,EAsHmBiB,KAtHnB,EAsH0B3D,KAtH1B,EAsHgC;;AAE1C,UAAIG,SAAYwD,KAAZ,WAAsB3D,KAAtB,OAAJ;;AAEA,UAAI8C,UAAUjC,oBAAoBkC,gBAApB,CAAqCL,SAArC,CAAd;AACAM,mBAAaF,QAAQG,MAAR,EAAb;AACAH,cAAQc,SAAR,CAAkBzD,MAAlB;AACA2C,cAAQe,IAAR;AACA,WAAKC,aAAL,CAAmBd,UAAnB,EAA+B7C,MAA/B;AACD,KA/HW;AAiIZ2D,iBAjIY,yBAiIEd,UAjIF,EAiIc7C,MAjId,EAiIqB;AAC7B,UAAI+C,YAAY,IAAI/E,SAAJ,CAAc6E,UAAd,CAAhB;AACA,UAAIG,QAAQ,IAAIjF,KAAJ,EAAZ;AACAiF,YAAMC,KAAN,GAAcjD,MAAd;AACA+C,gBAAUa,gBAAV,CAA2BZ,KAA3B,EAAkC,UAASa,QAAT,EAAkB;AAClD,YAAIC,SAASD,SAASC,MAAtB;AACA/E,aAAK+B,GAAL,CAASiD,SAAT,CAAmBD,MAAnB,EAA2B,IAA3B;AACH,OAHC;AAIH,KAzIW;AA2IZE,mBA3IY,2BA2IIhC,GA3IJ,EA2IQ;AAClB,UAAIiC,UAAUC,SAASC,sBAAT,CAAgC,UAAhC,EAA4C,CAA5C,CAAd;AACAF,cAAQG,KAAR,CAAcC,UAAd,GAA2B,SAA3B;AACA,UAAI1D,cAAc,IAAlB,EAAuB;AACrB2D,sBAAc,IAAIjG,MAAJ,CAAW;AACvBsD,iBAAO,OADgB;AAEvB4C,mBAAS;AAFc,SAAX,CAAd;AAIAD,oBAAYZ,IAAZ;AACA;AACD;AACD,UAAIc,GAAJ;AACA,UAAIhB,KAAJ;AACA,UAAIxD,MAAJ;AACA,UAAI+C,SAAJ;AACA,UAAIC,KAAJ;AACA,UAAIxB,WAAW,KAAK/B,MAAL,CAAY+B,QAA3B;;AAEA,WAAK,IAAIC,CAAT,IAAcD,QAAd,EAAuB;;AAErBiD,oBAAYjD,SAASC,CAAT,EAAY9B,EAAxB;;AAEA,YAAIgD,UAAUjC,oBAAoBkC,gBAApB,CAAqC6B,SAArC,CAAd;;AAEAjB,gBAAQhC,SAASC,CAAT,EAAY+B,KAApB;AACA;AACAxD,iBAAS,KAAK0E,mBAAL,CAA4BlB,KAA5B,gBAA2C7C,UAA3C,SAAT;AACA;AACA;AACAX,iBAAUW,UAAD,GAAeX,MAAf,GAA0B,OAAnC;AACA;;AAEA;AACA,YAAGY,YAAY,GAAf,EAAmB;AACjB+B,kBAAQc,SAAR,CAAkBzD,MAAlB;AACA,eAAKvB,EAAL,CAAQkG,WAAR,CAAoB,CAAChC,OAAD,CAApB,EAA+B,IAA/B;AAED,SAJD,MAKI;AACF,cAAG/B,YAAY6D,SAAf,EAAyB;AACvB9B,oBAAQc,SAAR,CAAkBzD,MAAlB;AACA,iBAAKvB,EAAL,CAAQkG,WAAR,CAAoB,CAAChC,OAAD,CAApB,EAA+B,IAA/B;AACD,WAHD,MAII;AACF,iBAAKlE,EAAL,CAAQkG,WAAR,CAAoB,CAAChC,OAAD,CAApB,EAA+B,KAA/B;AACD;AACF;AACF;;AAGD,WAAKiC,kBAAL,CAAwB,IAAxB;AACAX,cAAQG,KAAR,CAAcC,UAAd,GAA2B,QAA3B;AACD,KA/LW;AAiMZO,sBAjMY,8BAiMOC,MAjMP,EAiMc;AACxB,WAAKC,eAAL,CAAqBvB,GAArB,CAAyB,UAAzB,EAAqCsB,MAArC;AACA,WAAKvF,qBAAL,CAA2BiE,GAA3B,CAA+B,UAA/B,EAA2CsB,MAA3C;AACA,WAAK1C,qBAAL,CAA2BoB,GAA3B,CAA+B,UAA/B,EAA2CsB,MAA3C;AACA,WAAKxC,qBAAL,CAA2BkB,GAA3B,CAA+B,UAA/B,EAA2CsB,MAA3C;AACA,WAAKhD,sBAAL,CAA4B0B,GAA5B,CAAgC,UAAhC,EAA4CsB,MAA5C;AACD,KAvMW;AAyMZE,cAzMY,wBAyMA;AACT,WAAKH,kBAAL,CAAwB,KAAxB;AACA3E,2BAAqB,EAArB;AACAU,mBAAa,EAAb;AACA,UAAGzB,KAAKC,IAAL,CAAU,QAAV,EAAoB6F,QAApB,CAA6B,CAA7B,EAAgCA,QAAhC,CAAyC,CAAzC,EAA4CA,QAA5C,CAAqD,CAArD,EAAwDA,QAAxD,CAAiE,CAAjE,EAAoEA,QAApE,CAA6E,CAA7E,CAAH,EAAmF;;AAEhF,YAAG;AACD,cAAIC,aAAa,KAAK3F,qBAAL,CAA2BC,GAA3B,CAA+B,SAA/B,CAAjB;AACA,eAAKD,qBAAL,CAA2BiE,GAA3B,CAA+B,SAA/B,EAAyC,EAAzC;AACA,eAAKjE,qBAAL,CAA2BiE,GAA3B,CAA+B,SAA/B,EAAyC0B,UAAzC;AACA,eAAK9C,qBAAL,CAA2BoB,GAA3B,CAA+B,SAA/B,EAAyC,EAAzC;AACA,eAAKlB,qBAAL,CAA2BkB,GAA3B,CAA+B,SAA/B,EAA0C,EAA1C;AACArE,eAAKC,IAAL,CAAU,QAAV,EAAoB6F,QAApB,CAA6B,CAA7B,EAAgCA,QAAhC,CAAyC,CAAzC,EAA4CA,QAA5C,CAAqD,CAArD,EAAwDA,QAAxD,CAAiE,CAAjE,EAAoEA,QAApE,CAA6E,CAA7E,EAAgFE,SAAhF,GAA2FnG,KAAKE,YAAhG;AACAC,eAAKC,IAAL,CAAU,SAAV,EAAqB6F,QAArB,CAA8B,CAA9B,EAAiCA,QAAjC,CAA0C,CAA1C,EAA6CA,QAA7C,CAAsD,CAAtD,EAAyDA,QAAzD,CAAkE,CAAlE,EAAqEA,QAArE,CAA8E,CAA9E,EAAiFE,SAAjF,GAA4FnG,KAAKE,YAAjG;AACAC,eAAKC,IAAL,CAAU,SAAV,EAAqB6F,QAArB,CAA8B,CAA9B,EAAiCA,QAAjC,CAA0C,CAA1C,EAA6CA,QAA7C,CAAsD,CAAtD,EAAyDA,QAAzD,CAAkE,CAAlE,EAAqEA,QAArE,CAA8E,CAA9E,EAAiFE,SAAjF,GAA4FnG,KAAKE,YAAjG;AACD,SATD,CAUA,OAAMkG,CAAN,EAAQ;AACNtG,kBAAQC,GAAR,CAAY,iBAAZ;AACD;AAEH;AAEH,KA/NW;AAiOZsG,gBAjOY,0BAiOE;AACZ,WAAKR,kBAAL,CAAwB,KAAxB;AACA,WAAK1C,mBAAL,CAAyB1C,OAAzB,EAAkC,CAAlC,EAAqC,CAArC;AACA,WAAKuF,UAAL;AACA,WAAKf,eAAL,CAAqB,MAArB;AAED,KAvOW;AAyOZU,uBAzOY,+BAyOQ1E,MAzOR,EAyOe;AACzB;AACAC,2BAAqBD,MAArB;AACA,aAAOC,kBAAP;AACD;AA7OW;;AA+OZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA1Qa,G","file":"Widget.js","sourcesContent":["import declare from 'dojo/_base/declare';\r\nimport BaseWidget from 'jimu/BaseWidget';\r\nimport _WidgetsInTemplateMixin from 'dijit/_WidgetsInTemplateMixin';\r\nimport Query from \"esri/tasks/query\";\r\nimport QueryTask from \"esri/tasks/QueryTask\";\r\nimport dom from \"dojo/dom\";\r\nimport on from \"dojo/on\";\r\nimport lang from 'dojo/_base/lang';\r\nimport LayerInfos from 'jimu/LayerInfos/LayerInfos';\r\nimport Dialog from \"dijit/Dialog\";\r\nimport genFunction from \"./GenFunctions\"\r\nimport registry from \"dijit/registry\";\r\n\r\n// To create a widget, you need to derive from BaseWidget.\r\nexport default declare([\r\n  BaseWidget, \r\n  _WidgetsInTemplateMixin, \r\n  Query, \r\n  QueryTask], {\r\n\r\n  // Custom widget code goes here\r\n\r\n  baseClass: 'filter-features',\r\n  gf: genFunction(),\r\n\r\n  // add additional properties here\r\n\r\n  // methods to communication with app container:\r\n  postCreate () {\r\n    this.inherited(arguments);\r\n    console.log('FilterFeatures::postCreate');\r\n    self = this;\r\n\r\n  },\r\n  \r\n  startup() {\r\n    this.inherited(arguments);\r\n    self = this;\r\n    self.defaultEmpty = dojo.byId(\"selDep\").textContent;\r\n    self.defaultOption = self.depaSelectAttachPoint.get('value');\r\n\r\n\r\n    _idDepa = this.config.departamento.id;\r\n    _fieldCodDepa = this.config.departamento.value;\r\n    _fieldNomDepa = this.config.departamento.label;\r\n    clause = `${_fieldCodDepa} <> '99'`\r\n    _clauseTransversal = \"\";\r\n\r\n    _idProv = this.config.provincia.id;\r\n    _fieldCodProv = this.config.provincia.value;\r\n    _fieldNomProv = this.config.provincia.label;\r\n\r\n    _idDist = this.config.distrito.id;\r\n    _fieldCodDist = this.config.distrito.value;\r\n    _fieldNomDist = this.config.distrito.label;\r\n\r\n    _layerInfosObjClone = []\r\n    _codFilter = null;\r\n    _layerid = '0';\r\n    debugger\r\n\r\n    LayerInfos.getInstance(this.map, this.map.itemInfo)\r\n    .then(lang.hitch(this, function(layerInfosObj) {\r\n        _layerInfosObjClone = layerInfosObj;\r\n        var infos = layerInfosObj.getLayerInfoArray();\r\n        // this.gf._turnLayers(infos, true);\r\n      })\r\n    );\r\n\r\n    this._popLayers();\r\n\r\n    this._filterOptions(_idDepa, null, clause, _fieldCodDepa, _fieldNomDepa, self.depaSelectAttachPoint);\r\n  },\r\n\r\n  _popLayers(){\r\n    var options =[]\r\n    var features = this.config.features;\r\n\r\n    for (var i in features)\r\n    {\r\n      var opt = {\r\n        label: features[i].title,\r\n        value: features[i].id\r\n      };\r\n      options.push(opt);\r\n      this.LayerSelectAttachPoint.addOption(opt);\r\n    }\r\n  },\r\n\r\n  _filterLayer(evt){\r\n    _layerid = evt;\r\n  },\r\n\r\n  _filterFeatureDepa(evt){\r\n    debugger\r\n    var clause = `${_fieldCodProv} like '${evt}%'`\r\n\r\n    this._zoomExtendSelected(_idDepa, _fieldCodDepa, evt);\r\n    this._filterOptions(_idProv, evt, clause, _fieldCodProv, _fieldNomProv, self.provSelectAttachPoint);\r\n  },\r\n\r\n  _filterFeatureProv(evt){\r\n    var clause = `${_fieldCodDist} like '${evt}%'`\r\n\r\n    this._zoomExtendSelected(_idProv, _fieldCodProv, evt);\r\n    this._filterOptions(_idDist, evt, clause, _fieldCodDist, _fieldNomDist, self.distSelectAttachPoint);\r\n  },\r\n\r\n  _filterFeatureDist(evt){\r\n    _codFilter = evt;\r\n    this._zoomExtendSelected(_idDist, _fieldCodDist, _codFilter);\r\n  },\r\n\r\n  _filterOptions(idService, value, clause, valueField, labelField, dojonodeAlias){\r\n    _codFilter = value;\r\n    var feature = _layerInfosObjClone.getLayerInfoById(idService);\r\n    urlService = feature.getUrl();\r\n\r\n    var options = []\r\n    var queryTask = new QueryTask(urlService);\r\n    var query = new Query();\r\n    query.where = clause;\r\n    query.outFields = [valueField, labelField];\r\n    queryTask.execute(query, function(results){\r\n      for(var i in results.features){\r\n        var opt = {\r\n          label: results.features[i].attributes[labelField],\r\n          value: results.features[i].attributes[valueField]\r\n        };\r\n        options.push(opt);\r\n      }\r\n      options = self.gf._sortArray(options, 'label')\r\n      dojonodeAlias.set('options', options);\r\n    });\r\n  },\r\n\r\n  _zoomExtendSelected(idService, field, value){\r\n\r\n    var clause = `${field}='${value}'`;\r\n\r\n    var feature = _layerInfosObjClone.getLayerInfoById(idService);\r\n    urlService = feature.getUrl();\r\n    feature.setFilter(clause);\r\n    feature.show();\r\n    this._setMapExtent(urlService, clause);\r\n  },\r\n\r\n  _setMapExtent(urlService, clause){\r\n      var queryTask = new QueryTask(urlService);\r\n      var query = new Query();\r\n      query.where = clause;\r\n      queryTask.executeForExtent(query, function(response){\r\n        var extent = response.extent;\r\n        self.map.setExtent(extent, true);        \r\n    })\r\n  },\r\n\r\n  _filterFeatures(evt){\r\n    var spinner = document.getElementsByClassName(\"loaderff\")[0];\r\n    spinner.style.visibility = \"visible\"\r\n    if (_codFilter == null){\r\n      errorDialog = new Dialog({\r\n        title: \"Error\",\r\n        content: \"No ha seleccionado el ámbito de búsqueda!\",\r\n      });\r\n      errorDialog.show()\r\n      return;\r\n    }\r\n    var url;\r\n    var field;\r\n    var clause;\r\n    var queryTask;\r\n    var query;\r\n    var features = this.config.features;\r\n\r\n    for (var i in features){\r\n\r\n      idFeature = features[i].id;\r\n\r\n      var feature = _layerInfosObjClone.getLayerInfoById(idFeature);      \r\n\r\n      field = features[i].field;\r\n      debugger\r\n      clause = this._setClauseTraversal(`${field} like '${_codFilter}%'`);\r\n      // feature.setFilter(clause);\r\n      // feature.show();\r\n      clause = (_codFilter) ? clause   : \"1 = 1\";\r\n      // feature.setFilter(clause);\r\n\r\n      // Agregado para consultar solo la capa seleccionada\r\n      if(_layerid == '0'){\r\n        feature.setFilter(clause);\r\n        this.gf._turnLayers([feature], true);\r\n\r\n      }\r\n      else{\r\n        if(_layerid == idFeature){\r\n          feature.setFilter(clause);\r\n          this.gf._turnLayers([feature], true);\r\n        }\r\n        else{\r\n          this.gf._turnLayers([feature], false)\r\n        }\r\n      }\r\n    }\r\n    \r\n     \r\n    this._toggleEnabledForm(true);\r\n    spinner.style.visibility = \"hidden\"\r\n  },\r\n\r\n  _toggleEnabledForm(toggle){\r\n    this.buttonFiltrarff.set('disabled', toggle);\r\n    this.depaSelectAttachPoint.set(\"disabled\", toggle)\r\n    this.provSelectAttachPoint.set(\"disabled\", toggle)\r\n    this.distSelectAttachPoint.set(\"disabled\", toggle)\r\n    this.LayerSelectAttachPoint.set(\"disabled\", toggle)\r\n  },\r\n\r\n  _newFilter(){\r\n     this._toggleEnabledForm(false);\r\n     _clauseTransversal = '';\r\n     _codFilter = '';\r\n     if(dojo.byId(\"selDep\").children[0].children[0].children[0].children[0].children[0]){\r\n\r\n        try{\r\n          var depaoption = this.depaSelectAttachPoint.get('options')\r\n          this.depaSelectAttachPoint.set('options',[]);\r\n          this.depaSelectAttachPoint.set('options',depaoption);\r\n          this.provSelectAttachPoint.set('options',[]);\r\n          this.distSelectAttachPoint.set('options', []);\r\n          dojo.byId(\"selDep\").children[0].children[0].children[0].children[0].children[0].innerHTML= self.defaultEmpty;\r\n          dojo.byId(\"selProv\").children[0].children[0].children[0].children[0].children[0].innerHTML= self.defaultEmpty;\r\n          dojo.byId(\"selDist\").children[0].children[0].children[0].children[0].children[0].innerHTML= self.defaultEmpty;\r\n        }\r\n        catch(e){\r\n          console.log(\"no hay children\")\r\n        }       \r\n\r\n     }\r\n     \r\n  },\r\n\r\n  _clearFilter(){\r\n    this._toggleEnabledForm(false);\r\n    this._zoomExtendSelected(_idDepa, 1, 1);\r\n    this._newFilter();    \r\n    this._filterFeatures('none');\r\n\r\n  },\r\n\r\n  _setClauseTraversal(clause){\r\n    // _clauseTransversal = (_clauseTransversal) ? _clauseTransversal + ' or ' + clause : clause;\r\n    _clauseTransversal = clause;\r\n    return _clauseTransversal;\r\n  }\r\n\r\n  // onOpen() {\r\n  //   console.log('FilterFeatures::onOpen');\r\n  // },\r\n  // onClose(){\r\n  //   console.log('FilterFeatures::onClose');\r\n  // },\r\n  // onMinimize(){\r\n  //   console.log('FilterFeatures::onMinimize');\r\n  // },\r\n  // onMaximize(){\r\n  //   console.log('FilterFeatures::onMaximize');\r\n  // },\r\n  // onSignIn(credential){\r\n  //   console.log('FilterFeatures::onSignIn', credential);\r\n  // },\r\n  // onSignOut(){\r\n  //   console.log('FilterFeatures::onSignOut');\r\n  // }\r\n  // onPositionChange(){\r\n  //   console.log('FilterFeatures::onPositionChange');\r\n  // },\r\n  // resize(){\r\n  //   console.log('FilterFeatures::resize');\r\n  // }\r\n});\r\n"]}